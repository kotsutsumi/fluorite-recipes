# Auth監査ログ

「監査ログで認証イベントを監視および追跡します。」

## ログに記録される内容

Supabase auth監査ログは、以下を含むすべての認証イベントを自動的にキャプチャします:
- ユーザーのサインアップとログイン
- パスワードの変更とリセット
- メール検証イベント
- トークンの更新とログアウトイベント

## ストレージオプション

デフォルトでは、監査ログは2つの場所に保存されます:
1. **プロジェクトのPostgresデータベース** - `auth.audit_log_entries`テーブルに保存され、SQLで検索可能ですが、データベースストレージを使用します
2. **外部ログストレージ** - ダッシュボード経由でアクセス可能なコスト効率の高いストレージ

外部ログストレージを保持しながら、データベースストレージコストを削減するためにPostgresストレージを無効にできます。

### 監査ログストレージの設定

1. プロジェクトダッシュボードに移動
2. **認証**に移動
3. **設定**セクションの下の**監査ログ**を見つける
4. データベースストレージを無効にするには、「プロジェクトデータベースへのauth監査ログの書き込みを無効にする」をトグルオンにします

## ログ形式

監査ログには、各認証イベントに関する詳細情報が含まれています:

```json
{
  "timestamp": "2025-08-01T10:30:00Z",
  "user_id": "uuid",
  "action": "user_signedup",
  "ip_address": "192.168.1.1",
  "user_agent": "Mozilla/5.0...",
  "metadata": {
    "provider": "email"
  }
}
```

### ログアクションリファレンス

| アクション | 説明 |
|--------|-------------|
| `login` | ユーザーログイン試行 |
| `logout` | ユーザーログアウト |
| `invite_accepted` | チーム招待が承諾された |
| `user_signedup` | 新規ユーザー登録 |
| `user_invited` | ユーザー招待が送信された |
| `user_deleted` | ユーザーアカウントが削除された |
| `user_modified` | ユーザープロファイルが更新された |
| `user_recovery_requested` | パスワードリセットリクエスト |
| `user_reauthenticate_requested` | ユーザー再認証が必要 |
| `user_confirmation_requested` | メール/電話確認がリクエストされた |
| `user_repeated_signup` | 重複サインアップ試行 |
