# パスワードレスメールログイン

## マジックリンクまたはワンタイムパスワード（OTP）を使用したメールログイン

Supabase Authは、いくつかのパスワードレスログイン方法を提供しています。パスワードレスログインを使用すると、ユーザーは確認リンクをクリックするか、検証コードを入力することで、パスワードなしでサインインできます。

パスワードレスログインの利点：
- パスワードの作成と記憶をユーザーに要求しないことで、ユーザーエクスペリエンスを向上
- パスワード関連のセキュリティ侵害のリスクを減らすことで、セキュリティを向上
- パスワードリセットやその他のパスワード関連フローの処理に関するサポート負担を軽減

Supabase Authは、ユーザーのメールアドレスを使用する2つのパスワードレスログイン方法を提供しています：
- [マジックリンク](#マジックリンクを使用)
- [OTP](#otpを使用)

### マジックリンクを使用

マジックリンクは、ユーザーがメールアドレスに送信されたリンクをクリックしてアカウントにログインする、パスワードレスログインの一形態です。マジックリンクはメールアドレスでのみ機能し、1回限りの使用です。

#### マジックリンクの有効化

マジックリンクを含むメール認証方法は、デフォルトで有効になっています。

サイトURLと追加のリダイレクトURLを設定します。これらは、ユーザーがマジックリンクをクリックした後に許可される唯一のリダイレクト先URLです。

デフォルトでは、ユーザーは60秒ごとに1回のみマジックリンクをリクエストでき、1時間後に期限切れになります。

#### マジックリンクでサインイン

クライアントライブラリから「OTPでサインイン」メソッドを呼び出します。

メソッドは「OTP」とラベル付けされていますが、デフォルトでマジックリンクを送信します。2つのメソッドの違いは、ユーザーに送信される確認メールの内容のみです。

ユーザーがまだサインアップしていない場合、デフォルトで自動的にサインアップされます。これを防ぐには、`shouldCreateUser`オプションをfalseに設定します。

```javascript
const { data, error } = await supabase.auth.signInWithOtp({
  email: 'valid.email@supabase.io',
  options: {
    emailRedirectTo: 'https://example.com/welcome',
  },
})
```

### OTPを使用

メールワンタイムパスワード（OTP）は、ユーザーがメールアドレスに送信された6桁のコードを入力してアカウントにログインする、パスワードレスログインの一形態です。

#### メールOTPの有効化

メールOTPを含むメール認証方法は、デフォルトで有効になっています。

メールOTPはマジックリンクと実装を共有しています。マジックリンクの代わりにOTPを送信するには、マジックリンクのメールテンプレートを変更します。

デフォルトでは、ユーザーは60秒ごとに1回のみOTPをリクエストでき、1時間後に期限切れになります。

```javascript
const { data, error } = await supabase.auth.signInWithOtp({
  email: 'valid.email@supabase.io',
})
```

#### OTPの検証

```javascript
const { data: { session }, error } = await supabase.auth.verifyOtp({
  email: 'valid.email@supabase.io',
  token: '123456',
  type: 'email',
})
```
