# オーナーシップ

Supabase Storageで新しいバケットやオブジェクトを作成すると、オーナーが自動的に割り当てられます:

- オーナーは、リソースを作成したユーザーです
- オーナーの値は、JWTの`sub`クレームから派生します
- オーナーは`owner_id`カラムに保存されます

## 重要な注意事項

> `service_key`を使用してリソースを作成する場合、オーナーは設定されず、リソースは誰でも所有できます。

> Storageスキーマには、オーナーシップを表す2つのフィールドがあります: `owner`と`owner_id`。`owner`は非推奨であり、削除される予定です。代わりに`owner_id`を使用してください。

## アクセス制御

オーナーシップ自体は自動的なアクセス制御を提供しません。ただし、リソースのオーナーにスコープされたアクセス制御を実装することで、オーナーシップを強制できます。

### ポリシーの例

以下は、オーナーのみがオブジェクトを削除できるようにする行レベルセキュリティ（RLS）ポリシーの例です:

```sql
create policy "User can delete their own objects"
on storage.objects
for delete
to authenticated
using (
 owner_id = (select auth.uid())
);
```

ドキュメントでは、RLSポリシーはアクセス制御を強制する1つの方法に過ぎないと指摘しています。サーバーコードで同様のアクセス制御ロジックを実装することもできます。
