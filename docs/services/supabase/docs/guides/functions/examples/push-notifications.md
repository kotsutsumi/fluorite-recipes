# プッシュ通知の送信

このガイドでは、プッシュ通知を実装するための2つの主要な方法について説明します。

## 1. Expoプッシュ通知

### 主要な手順：
- Expoのプッシュ通知サービスを利用
- iOSとAndroid向けのクロスプラットフォーム通知処理を簡素化
- Firebase/APNsを通じてデバイス情報とメッセージングを処理

#### セットアップ手順：
1. 新しいSupabaseプロジェクトを作成
2. Supabase CLIでプロジェクトをリンク
3. Supabaseをローカルで起動
4. データベーススキーマをプッシュ

#### Expo設定：
- 依存関係をインストール
- Expoプロジェクトを作成
- 開発ビルドをセットアップ
- Expoアクセストークンを生成

#### セキュリティの強化：
- Expoアクセストークン設定に移動
- 新しいトークンを作成
- 「Enhanced Security for Push Notifications」を有効化

#### デプロイ：
- Supabaseエッジファンクションをデプロイ
- `EXPO_ACCESS_TOKEN` シークレットを設定
- データベースウェブフックを作成
- 通知挿入時にトリガーされるようウェブフックを設定

## 2. Firebase Cloud Messaging（FCM）

### 主要な手順：
- GoogleのFCMサービス経由でプッシュ通知を送信
- iOS、Android、Webプラットフォームをサポート
- ユーザートークンと通知用の特定のデータベーステーブルの作成が必要

#### セットアップ要件：
- FCMトークン列を持つ `profiles` テーブルを作成
- `notifications` テーブルを作成
- Firebaseサービスアカウントキーを生成
- クライアント側のFCM統合を設定

#### デプロイ手順：
- エッジファンクションを作成
- ファンクションをデプロイ
- データベースウェブフックを設定
- プッシュをトリガーするための通知を挿入

### 実装のハイライト：
- Supabaseエッジファンクションを使用
- データベースウェブフックを活用
- リアルタイム通知トリガーをサポート

このドキュメントでは、ExpoとFCMの両方のアプローチについて、詳細なコード例とステップバイステップの手順を提供しています。
