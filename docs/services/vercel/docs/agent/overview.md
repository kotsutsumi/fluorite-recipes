# Vercel Agent の概要

## 概要

Vercel Agentは、AIを活用したコードレビューツールで、プルリクエストの分析、問題の検出、修正提案を自動的に行います。

### 対象プラン

- **エンタープライズプラン**
- **Proプラン**

### ステータス

**ベータ版** - 現在ベータ版として提供されています

## 主な特徴

### AIによる多段階の推論

Vercel Agentは、以下のプロセスでコード変更を分析します：

1. **コード変更の分析**: プルリクエストの差分を詳細に分析
2. **問題の検出**: 潜在的なバグ、パフォーマンス問題、セキュリティリスクを検出
3. **セキュアなサンドボックスでの実行**: 安全な環境で問題を再現
4. **修正提案の生成**: 具体的なコード修正を提案
5. **プルリクエスト内での提示**: PR内で直接修正を提案

### セキュアなサンドボックス

- **分離された環境**: 本番環境から完全に分離
- **安全な実行**: コードの実行は制御された環境で行われる
- **データ保護**: コードや実行結果は外部に漏洩しない

### 直接的なコード修正提案

- **インラインコメント**: PR内で直接修正を提案
- **具体的な変更**: 実装可能な具体的なコード変更を提示
- **説明付き**: なぜその修正が必要かを説明

## セットアップ方法

### 1. ダッシュボードから有効化

1. Vercelダッシュボードにログイン
2. 「Agent」タブに移動
3. 「有効化」ボタンをクリック

### 2. リポジトリ設定

リポジトリの範囲を選択：

#### オプション1: すべてのリポジトリ（デフォルト）

- Vercelに接続されているすべてのリポジトリで有効
- 新しいリポジトリも自動的に対象に含まれる

#### オプション2: 公開リポジトリのみ

- 公開リポジトリのみでVercel Agentが動作
- プライベートリポジトリは対象外

#### オプション3: プライベートリポジトリのみ

- プライベートリポジトリのみでVercel Agentが動作
- 公開リポジトリは対象外

### 3. ドラフトPRの設定

ドラフトプルリクエストをレビュー対象に含めるかを選択：

- **有効**: ドラフトPRもレビュー対象
- **無効**: ドラフトPRはレビュー対象外（デフォルト）

### 4. 自動補充の設定（オプション）

自動補充機能を有効にすると、使用量が設定した閾値を下回った際に自動的にクレジットが追加されます：

1. 「自動補充」トグルを有効化
2. 補充額を設定（例：$100）
3. 閾値を設定（例：残高が$20を下回ったら補充）

## 価格

Vercel Agentの料金は、以下の2つのコンポーネントで構成されます：

### 固定費

- **レビュー1回あたり**: $0.30
- すべてのレビューに適用される基本料金

### トークンコスト

- **AIプロバイダーの料金に基づく**: 使用したトークン数に応じて変動
- 複雑なコード変更ほど、多くのトークンを使用
- リアルタイムで使用量を確認可能

### 料金例

```
小規模なPR（100行の変更）:
固定費: $0.30
トークンコスト: 約$0.10
合計: 約$0.40

中規模なPR（500行の変更）:
固定費: $0.30
トークンコスト: 約$0.50
合計: 約$0.80

大規模なPR（1000行以上の変更）:
固定費: $0.30
トークンコスト: 約$1.00〜
合計: 約$1.30〜
```

## プライバシーとセキュリティ

### データの取り扱い

- **データは保存されない**: Vercel Agentはコードやレビュー結果を保存しません
- **学習されない**: あなたのコードはAIモデルの学習に使用されません
- **セキュアな通信**: すべての通信は暗号化されます

### LLMプロバイダー

Vercel Agentは、Vercelの[サブプロセッサリスト](https://vercel.com/legal/subprocessors)に記載されたLLMプロバイダーのみを使用します：

- **OpenAI**: GPTモデル
- **Anthropic**: Claudeモデル
- その他の承認されたプロバイダー

### セキュリティ対策

- **サンドボックス実行**: コードは分離された環境で実行
- **アクセス制御**: チームメンバーのみがレビュー結果にアクセス可能
- **監査ログ**: すべてのレビューアクティビティが記録される

## 分析対象ファイル

Vercel Agentは、以下の種類のファイルを分析します：

### ソースコードファイル

- **JavaScript/TypeScript**: `.js`, `.jsx`, `.ts`, `.tsx`
- **Python**: `.py`
- **Go**: `.go`
- **Ruby**: `.rb`
- **Java**: `.java`
- **C/C++**: `.c`, `.cpp`, `.h`, `.hpp`
- **Rust**: `.rs`
- **PHP**: `.php`
- その他の一般的なプログラミング言語

### テストファイル

- **Jest**: `.test.js`, `.spec.js`
- **Mocha**: `test/*.js`
- **pytest**: `test_*.py`, `*_test.py`
- **Go Test**: `*_test.go`
- その他のテストフレームワーク

### 設定ファイル

- **Package管理**: `package.json`, `requirements.txt`, `go.mod`
- **ビルド設定**: `webpack.config.js`, `tsconfig.json`, `vite.config.js`
- **CI/CD**: `.github/workflows/*.yml`, `.gitlab-ci.yml`
- **Vercel設定**: `vercel.json`

### ドキュメンテーション

- **README**: `README.md`
- **ドキュメント**: `docs/*.md`
- **コメント**: コード内のコメント

### 分析対象外のファイル

以下のファイルは分析されません：

- バイナリファイル
- メディアファイル（画像、動画、音声）
- 大規模な生成ファイル（ビルド出力など）
- `node_modules`、`.git`などの依存関係ディレクトリ
- ロックファイル（`package-lock.json`、`yarn.lock`など）

## レビュープロセス

### 1. プルリクエストの作成

開発者が通常通りプルリクエストを作成します。

### 2. Vercel Agentの起動

プルリクエストが作成されると、Vercel Agentが自動的に起動します：

- 変更内容を分析
- 潜在的な問題を検出
- 修正提案を生成

### 3. レビュー結果の提示

Vercel Agentは、PR内でレビュー結果を提示します：

- **コメント**: 問題が見つかった箇所にコメント
- **修正提案**: 具体的なコード変更を提案
- **説明**: なぜその修正が必要かを説明

### 4. 開発者のアクション

開発者は、Vercel Agentの提案を確認し、以下のアクションを取ります：

- **承認**: 提案を受け入れてコードに適用
- **拒否**: 提案を拒否
- **ディスカッション**: コメントで議論

### 5. レビューの完了

すべての提案が処理されたら、通常通りプルリクエストをマージします。

## 検出される問題の種類

### バグ

- **Null参照エラー**: Null/undefinedへのアクセス
- **型エラー**: 型の不一致
- **ロジックエラー**: 条件分岐の誤り
- **無限ループ**: 終了しないループ

### パフォーマンス

- **不要な再レンダリング**: React等での最適化不足
- **メモリリーク**: メモリの解放漏れ
- **非効率なアルゴリズム**: O(n^2)以上の複雑度
- **過剰なAPI呼び出し**: 不要なネットワークリクエスト

### セキュリティ

- **SQLインジェクション**: SQLクエリの脆弱性
- **XSS**: クロスサイトスクリプティング
- **CSRF**: クロスサイトリクエストフォージェリ
- **機密情報の露出**: ハードコードされたシークレット

### ベストプラクティス

- **コーディング規約違反**: 命名規則、フォーマット等
- **アクセシビリティ**: a11yの問題
- **SEO**: メタタグ、構造化データの問題
- **依存関係**: 古いライブラリ、セキュリティアップデート

## 制限事項

### レビューサイズ

- **最大ファイル数**: 100ファイルまで
- **最大行数**: 10,000行まで
- 大規模なPRは、複数の小さなPRに分割することを推奨

### 対応言語

- 主要なプログラミング言語をサポート
- ニッチな言語は部分的なサポートまたは非対応の可能性

### 実行時間

- **タイムアウト**: レビューは最大10分まで
- 複雑なPRは時間がかかる可能性

## ベストプラクティス

### 1. 小さなPRを作成

- 1つのPRで1つの機能または修正に焦点
- レビューの精度と速度が向上

### 2. 明確なコミットメッセージ

- Vercel Agentがコンテキストを理解しやすくなる
- より的確な提案が可能

### 3. テストを含める

- テストがあると、Vercel Agentがより正確に問題を検出
- 修正提案もより具体的に

### 4. ドキュメントを更新

- コード変更に伴うドキュメント更新も含める
- Vercel Agentがドキュメントの整合性をチェック

## 詳細情報

Vercel Agentの使用方法や詳細な分析例については、[使用方法](/docs/agent/usage)ページを参照してください。

## 関連リソース

- [Vercel Agent使用方法](/docs/agent/usage)
- [AI SDK](/docs/ai-sdk)
- [セキュリティベストプラクティス](/docs/security)
- [プルリクエストのベストプラクティス](/docs/git/pull-requests)
