# Functionsのレガシー使用量と料金

## 概要

「レガシー課金モデル: このページでは、レガシー課金モデルについて説明し、Fluid Computeを使用していない関数に関連します。」

### 関数の測定

Node.jsランタイムを使用する関数はGB-hoursで測定されます:

- 割り当てられたメモリ(GB)×実行時間で計算
- 例: 3GBメモリで1秒間実行される関数は3 GB-sで課金されます
- 完全なGB-Hourに達するには1,200回の実行が必要

関数は実行単位あたり最大50ミリ秒のCPU時間を使用できます。これを超えると、関数は複数の50ミリ秒の課金単位に分割されます。

## 料金

### 含まれる使用量の制限

| リソース | Hobby含まれる | Pro含まれる | Proでのオンデマンド |
|----------|----------------|--------------|---------------------|
| 関数の継続時間 | 最初の100 GB-Hours | N/A | 1 GB-Hourあたり$0.18 |
| 関数の呼び出し | 最初の100,000 | N/A | 100万呼び出しあたり$0.60 |

### Hobbyプランの詳細

- 使用量制限に近づくとVercelがメールを送信
- 制限を超えるとアカウントが一時停止される可能性があります
- 一時停止されたアカウントはアクションが取られるまで非アクティブのまま

### Proプランの詳細

- Proトライアルは、チームがトライアル制限に達すると終了
- 含まれる使用量を超えるとオンデマンド料金が発生
- 通知と自動アクションのためにSpend Managementを設定可能

### Enterpriseプラン

Enterprise契約では以下を提供:

- カスタム実行単位
- 増加した最大継続時間(最大900秒)
- マルチリージョンデプロイメント
- 関数のフェイルオーバー

## 使用量の追跡

使用量メトリクスは、ダッシュボードのUsageタブで利用できます。

### 主要なメトリクス

- 関数の呼び出し
- 関数の継続時間
- スロットリング

## 最適化戦略

### 関数の呼び出しの管理

- キャッシングを使用
- Cache-Controlヘッダーを実装
- 不要な関数呼び出しを削減

### 関数の継続時間の管理

- 最大関数継続時間を調整
- エッジキャッシングを使用
- 関数コードの効率を最適化

## スロットル

スロットルは、同時実行制限に達したときに発生し、`503: FUNCTION_THROTTLED`エラーが発生します
