# DNSレコードの管理

Vercelでドメイ

ンのDNSレコードを管理する方法を説明します。

## 概要

ドメインがVercelのネームサーバーを使用している場合、チームのDomainsページからDNSレコードを管理できます。

## DNSレコードの追加

### 手順

1. ダッシュボードからドメインを選択
2. **Enable Vercel DNS**をクリック
3. DNSレコードフォームに以下を入力:
   - **Name**: レコードのプレフィックス/ロケーション
   - **Type**: `A`, `AAAA`, `ALIAS`, `CAA`, `CNAME`, `HTTPS`, `MX`, `NS`, `SRV`, `TXT`
   - **Value**: レコードの値
   - **TTL**: デフォルトは60秒
   - **Comment**: オプションのコメント

### 伝播時間

DNSレコードが完全に更新されるまで、**最大24時間**かかる場合があります。

## DNSレコードの検証

### サードパーティツールの使用

- **DNS Checker**: https://dnschecker.org
- **DNS Map**: https://dnsmap.io

### ターミナルコマンドの使用

#### Aレコードの確認

```bash
dig A api.example.com +short
```

#### MXレコードの確認

```bash
dig MX example.com +short
```

## DNSレコードの削除

### 手順

1. Domainsページに移動
2. ドメインを選択
3. 省略記号（⋯）メニューを使用して「Delete DNS Zone」を選択

### 重要な注意事項

**デフォルトレコードは削除できませんが、新しいレコードで上書きできます**

## DNSプリセット

### 用途

Vercelがサポートしていないサードパーティサービス用のDNSレコードを自動的に設定します。

### 使用方法

1. プロバイダーリストから選択
2. 必要なDNSレコードが自動的に追加される

### サポートされているサービス

- メールプロバイダー（ImprovMX、Forward Emailなど）
- その他のサードパーティサービス

## DNSレコードの移行

### 移行手順

1. **現在のDNS設定のクローン**
   - 既存のDNSレコードをすべて記録

2. **レコードの検証**
   - すべてのレコードがクローンされたか確認

3. **レジストラでのネームサーバー切り替え**
   - Vercelのネームサーバーに変更

### 推奨事項

ネームサーバーを切り替える前に、**すべてのレコードを確認**してください。

## よくあるDNSレコード設定例

### Apexドメイン（Vercel）

```
Type: A
Name: @
Value: 76.76.21.21
TTL: 60
```

### WWWサブドメイン（Vercel）

```
Type: CNAME
Name: www
Value: cname.vercel-dns.com
TTL: 60
```

### メールサーバー（ImprovMX）

```
Type: MX
Name: @
Value: mx1.improvmx.com
Priority: 10
TTL: 60

Type: MX
Name: @
Value: mx2.improvmx.com
Priority: 20
TTL: 60
```

### SSL証明書検証（TXT）

```
Type: TXT
Name: _vercel
Value: vc-domain-verify=abc123...
TTL: 60
```

## ベストプラクティス

### 1. TTLの適切な設定

- **変更前**: TTLを60秒に短縮
- **安定後**: TTLを3600秒（1時間）または86400秒（24時間）に延長

### 2. レコードのバックアップ

重要なDNSレコードは、変更前にバックアップしてください。

### 3. 段階的な移行

一度にすべてのレコードを変更するのではなく、段階的に移行します。

### 4. 検証の実施

各レコード追加後、正しく機能しているか検証します。

## トラブルシューティング

### レコードが反映されない

1. **伝播時間を待つ**: 最大24〜48時間
2. **DNSキャッシュをクリア**: ローカルおよびブラウザのキャッシュ
3. **レコードの正確性を確認**: タイプミスや不正な値

### 競合するレコード

同じ名前とタイプのレコードが複数ある場合、予期しない動作が発生する可能性があります。

**解決策**: 重複レコードを削除

## 関連ドキュメント

- [DNSの操作](/docs/domains/working-with-dns)
- [ネームサーバーの操作](/docs/domains/working-with-nameservers)
- [ドメインのトラブルシューティング](/docs/domains/troubleshooting)

## まとめ

Vercelのネームサーバーを使用することで、ダッシュボードから直接DNSレコードを管理でき、設定が簡素化されます。適切なレコードタイプを選択し、検証を行うことで、スムーズなドメイン管理が可能です。
