# Bring Your Own Key (BYOK)

独自の資格情報を外部AIプロバイダーで使用することで、AI Gatewayは追加のマークアップなしでリクエストを認証できます。この方法は、AIプロバイダーが提供するクレジットを利用したり、プライベートクラウドデータにアクセスするAIクエリを実行したりする際に役立ちます。独自の資格情報を使用したクエリが失敗した場合、AI Gatewayはサービスの可用性を向上させるために、システムの資格情報で再試行します。

## はじめに

### AIプロバイダーから資格情報を取得

まず、AIプロバイダーから資格情報を取得します。これらの資格情報は、AI Gatewayを通じてそのプロバイダーへのリクエストを最初に認証するために使用されます。

### Vercelチームに資格情報を追加

1. [AI Gateway](https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2F&title=)タブに移動
2. 左サイドバーの「統合」セクションをクリック
3. プロバイダーを見つけて「追加」をクリック
4. ダイアログに資格情報を入力
5. 「有効」トグルをオンにして資格情報をアクティブ化
6. 「キーをテスト」をクリックして検証と追加を行う

### AI Gatewayリクエストで資格情報を使用

資格情報が追加されると、AI Gatewayへのリクエストに自動的に含まれます。追加の設定は不要です。

## 資格情報のテスト

資格情報が正しく設定されているかテストするには：

1. AI Gateway タブの「統合」セクションに移動
2. テストするプロバイダーを見つける
3. 「キーをテスト」をクリック
4. テスト結果を確認

## サポートされているプロバイダー

以下のプロバイダーで BYOK をサポートしています：

- **Anthropic**: Claude モデル用
- **OpenAI**: GPT モデル用
- **Google AI**: Gemini モデル用
- **AWS Bedrock**: さまざまなモデル用
- **Azure OpenAI**: Azure でホストされる OpenAI モデル用

## メリット

### コスト削減

- プロバイダーから直接提供されるクレジットや割引を使用
- AI Gateway からの追加マークアップなし
- 既存の契約や割引を活用

### データプライバシー

- プライベートクラウドデータへのアクセス
- データがプロバイダーのネットワーク内に留まる
- コンプライアンス要件を満たす

### 柔軟性

- 複数のプロバイダーアカウントを管理
- プロジェクトごとに異なる資格情報を使用
- 既存のインフラストラクチャと統合

## フォールバック動作

独自の資格情報を使用したリクエストが失敗した場合、AI Gateway は自動的に以下のフォールバックを試みます：

1. **他の資格情報を試行**: 同じプロバイダーの他の有効な資格情報がある場合、それを使用
2. **システム資格情報を使用**: すべてのユーザー提供の資格情報が失敗した場合、AI Gateway のシステム資格情報を使用
3. **他のプロバイダーを試行**: 設定されている場合、他のプロバイダーにフォールバック

このフォールバック動作により、高い可用性と信頼性が保証されます。

## 資格情報の管理

### 資格情報の更新

1. AI Gateway タブの「統合」セクションに移動
2. 更新するプロバイダーを見つける
3. 「編集」をクリック
4. 新しい資格情報を入力
5. 「保存」をクリック

### 資格情報の無効化

1. AI Gateway タブの「統合」セクションに移動
2. 無効化するプロバイダーを見つける
3. 「有効」トグルをオフにする

無効化された資格情報は、AI Gateway リクエストに使用されなくなりますが、削除されません。

### 資格情報の削除

1. AI Gateway タブの「統合」セクションに移動
2. 削除するプロバイダーを見つける
3. 「削除」をクリック
4. 確認ダイアログで「削除」をクリック

削除された資格情報は完全に削除され、復元できません。

## セキュリティのベストプラクティス

### 資格情報の保護

- 資格情報を安全な場所に保管
- 必要最小限の権限を持つ資格情報を使用
- 定期的に資格情報をローテーション

### アクセス制御

- チームメンバーに適切な権限を付与
- 資格情報へのアクセスを監視
- 不要になった資格情報を削除

### 監視とアラート

- 資格情報の使用状況を監視
- 異常なアクティビティに対してアラートを設定
- 定期的にアクセスログを確認

## トラブルシューティング

### 資格情報が機能しない

**症状**: リクエストが認証エラーで失敗する

**解決策**:
- 資格情報が正しいか確認
- 資格情報が有効で、期限切れでないか確認
- プロバイダーのダッシュボードで資格情報の状態を確認
- 「キーをテスト」機能を使用して資格情報を検証

### フォールバックが機能しない

**症状**: 独自の資格情報が失敗した後、リクエストが完全に失敗する

**解決策**:
- フォールバックオプションが有効になっているか確認
- 他のプロバイダーが設定されているか確認
- AI Gateway の観測性ダッシュボードでエラーログを確認

## よくある質問

### BYOK を使用すると、AI Gateway クレジットは消費されますか？

いいえ、独自の資格情報を使用する場合、AI Gateway クレジットは消費されません。プロバイダーに直接課金されます。

### 複数の資格情報を同じプロバイダーに追加できますか？

はい、同じプロバイダーに複数の資格情報を追加できます。AI Gateway は、利用可能な資格情報の中から自動的に選択します。

### 資格情報は他のチームメンバーと共有されますか？

はい、資格情報はチームレベルで管理され、チームのすべてのプロジェクトで使用できます。適切なアクセス制御を設定してください。

## 関連リンク

- [認証](/docs/ai-gateway/authentication)
- [プロバイダオプション](/docs/ai-gateway/provider-options)
- [はじめに](/docs/ai-gateway/getting-started)
