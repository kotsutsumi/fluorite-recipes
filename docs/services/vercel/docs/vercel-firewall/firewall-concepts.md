# Firewall Concepts

## Vercelによるリクエストのセキュリティ保護

Vercelのプラットフォーム全体のファイアウォールは、リクエストがVercelのCDNに到達した時点で最初の防御線として機能します。セキュリティ保護は以下の層で行われます：

1. プラットフォーム全体のファイアウォール
2. デプロイメント保護
3. Web Application Firewall (WAF)

![Vercelのリクエスト保護レイヤー](/vc-ap-vercel-docs/_next/image?url=https%3A%2F%2F7nyt0uhk7sse4zvn.public.blob.vercel-storage.com%2Fdocs-assets%2Fstatic%2Fdocs%2Fsecurity%2Fvercel-firewall-protection-concept-light.png&w=1200&q=75)

## ファイアウォールのアクション

Vercelファイアウォールは、トラフィックに対して以下のアクションを提供します：

### ログ
- リクエストを通常通り処理
- リクエストの詳細を記録
- ユーザーエクスペリエンスに影響なし

### 拒否
- リクエストを即座にブロック
- `403 Forbidden`レスポンスを返す
- アプリケーションにリクエストを到達させない

### チャレンジ
- ブラウザからのトラフィックであることを検証
- JavaScriptを実行できるクライアントのみ通過
- 1時間有効なセッションを作成

### バイパス
- 特定のトラフィックソースを信頼
- カスタムルールやシステムレベルの緩和をスキップ
- 信頼できるパートナーやサービスに使用

## DDoSの理解

DDoS（分散型サービス拒否）攻撃は、大量のトラフィックでシステムを圧倒し、正当なユーザーがサービスにアクセスできなくすることを目的としています。

Vercelは以下の方法でDDoSを緩和します：

- トラフィックパターンの継続的な監視
- 異常なトラフィックスパイクの自動検出
- 悪意のあるIPアドレスの即座のブロック
- 正当なトラフィックの優先的な処理

## JA3とJA4 TLS指紋

Vercelファイアウォールは、JA3およびJA4 TLS指紋を使用して、悪意のあるクライアントを識別します：

### JA3指紋
- クライアントのTLSハンドシェイクからユニークな指紋を生成
- ボットや自動化ツールの識別に使用
- 同じツールは同じJA3指紋を持つ

### JA4指紋
- JA3の改良版
- より正確な識別が可能
- 偽装に対してより強固

これらの指紋は、カスタムルールで使用して、特定のクライアントタイプをブロックまたは許可できます。

## ファイアウォールルールの優先順位

ルールは以下の順序で評価されます：

1. システムバイパスルール（最高優先度）
2. IPブロッキングルール
3. カスタムルール
4. レートリミットルール
5. マネージドルールセット（最低優先度）

最初にマッチしたルールが適用され、それ以降のルールは評価されません。
