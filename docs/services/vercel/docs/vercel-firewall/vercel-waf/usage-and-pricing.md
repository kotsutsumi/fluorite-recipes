# Vercel WAF の使用量と価格

Vercel Firewall の機能は、すべてのプランで無料で利用できます。これには以下が含まれます：

- [DDoS 軽減](/docs/security/ddos-mitigation)
- [IP ブロッキング](/docs/security/vercel-waf/ip-blocking)
- [カスタムルール](/docs/security/vercel-waf/custom-rules)

プラン固有の機能（[レート制限](/docs/security/vercel-waf/rate-limiting)や[マネージドルールセット](/docs/security/vercel-waf/managed-rulesets)）は、以下に示す価格設定に従って課金されます。

## 無料機能の使用

無料の Firewall 機能を使用しても課金されませんが、以下の使用量が発生する可能性があります：

| 機能 | Edge Requests | Fast Data Transfer | 備考 |
|------|--------------|-------------------|------|
| WAF カスタムルール | 課金対象 | 課金対象 | カスタムルールがアクティブな場合、チャレンジまたは拒否されたリクエストごとに使用量が発生 |
| WAF 永続的アクションを伴うカスタムルール | 課金対象外 | 課金対象外 | リクエストはファイアウォールで処理される前にブロックされるため |
| DDoS 軽減 | 課金対象外 | 課金対象外 | 詳細は「DDoS の課金について」を参照 |
| アタックチャレンジモード | 課金対象外 | 課金対象外 | チャレンジに合格しないリクエストは使用量にカウントされない |
| IP ブロッキング | 課金対象外 | 課金対象外 | ブロックされたリクエストは使用量にカウントされない |

## レートリミットの価格

レートリミット機能は、すべてのプランで利用可能で、以下の料金が適用されます：

- **基本料金**: 月額 $10 / プロジェクト
- **追加使用量**: $0.50 / 100万リクエスト

### レートリミットの課金対象

- レートリミットルールによって評価されたすべてのリクエスト
- 制限内のリクエストと制限を超えたリクエストの両方

### 課金されないケース

- レートリミットルールが無効な場合
- レートリミットルールの条件にマッチしないリクエスト

## マネージドルールセットの価格

マネージドルールセットは、Enterpriseプランで利用可能です。

### OWASPコアルールセット

- **基本料金**: 月額 $1,000 / プロジェクト
- **追加使用量**: $1.00 / 100万リクエスト
- **パラノイアレベル**: すべてのレベル（1-4）で同一料金

### ボット保護マネージドルールセット

- **基本料金**: 月額 $500 / プロジェクト
- **追加使用量**: $0.50 / 100万リクエスト

### AIボットマネージドルールセット

- **基本料金**: 月額 $200 / プロジェクト
- **追加使用量**: $0.25 / 100万リクエスト

### マネージドルールセットの課金対象

- マネージドルールセットによって評価されたすべてのリクエスト
- ログ、チャレンジ、拒否のいずれのアクションでも課金

## DDoS緩和の課金について

DDoS緩和によってブロックされたリクエストは、以下の条件で課金されません：

- システムレベルで自動的にブロックされたリクエスト
- 攻撃チャレンジモードでチャレンジに失敗したリクエスト

ただし、以下の場合は通常の使用量が発生します：

- 攻撃チャレンジモードでチャレンジに合格したリクエスト
- システム緩和後にアプリケーションに到達したリクエスト

## 使用量の最適化

### コストを抑えるためのベストプラクティス

1. **永続的アクションの活用**: 繰り返し攻撃してくるIPアドレスには永続的拒否アクションを使用
2. **IPブロッキングの優先**: 既知の悪意のあるIPアドレスは、カスタムルールではなくIPブロッキングでブロック
3. **レートリミットの最適化**: 必要なエンドポイントのみにレートリミットを適用
4. **ルールの整理**: 不要なルールを無効化または削除
5. **バイパスルールの活用**: 信頼できるトラフィックソースをバイパスし、不要な評価を避ける

### 使用量の監視

1. Vercelダッシュボードで使用量を確認
2. プロジェクト設定 > Usage タブで詳細を表示
3. アラートを設定して使用量の急増を検知

## 料金プランの比較

| 機能 | Hobby | Pro | Enterprise |
|------|-------|-----|------------|
| DDoS緩和 | 無料 | 無料 | 無料 |
| IPブロッキング | 無料 | 無料 | 無料 |
| カスタムルール | 無料 | 無料 | 無料 |
| レートリミット | $10/月 + 使用量 | $10/月 + 使用量 | $10/月 + 使用量 |
| OWASPルールセット | - | - | $1,000/月 + 使用量 |
| ボット保護 | - | - | $500/月 + 使用量 |
| AIボット保護 | - | - | $200/月 + 使用量 |
| 永続的アクション | - | 利用可能 | 利用可能 |
| システムバイパス | - | 利用可能 | 利用可能 |

## 請求サイクル

- 月額料金は月初に請求
- 使用量ベースの料金は月末に計算
- プロレート（日割り）計算が適用される場合あり

## よくある質問

### Q: レートリミットを無効にすると料金は発生しますか？

A: いいえ、レートリミットルールを無効にすると、基本料金も使用量ベースの料金も発生しません。

### Q: プレビューデプロイメントにも課金されますか？

A: はい、プレビューデプロイメントへのリクエストも本番デプロイメントと同様に課金されます。

### Q: マネージドルールセットを一時的に無効にできますか？

A: はい、いつでも有効/無効を切り替えられます。無効期間中は料金が発生しません。

### Q: 複数のプロジェクトで使用する場合は？

A: 料金はプロジェクトごとに計算されます。各プロジェクトに個別に基本料金と使用量料金が適用されます。

## サポート

料金に関する質問や、カスタム価格設定が必要な場合は、[Vercelセールスチーム](https://vercel.com/contact/sales)にお問い合わせください。

詳細な使用量レポートは、ダッシュボードの「Usage」タブから確認できます。
