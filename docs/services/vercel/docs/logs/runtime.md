# ランタイムログ

## 概要

ランタイムログはすべてのVercelプランで利用可能で、Function呼び出しとリクエスト処理に関する詳細なインサイトを提供します。

## ランタイムログとは

ランタイムログには、以下によって生成されたログが含まれます：

- Vercel Functions呼び出し
- ルーティングミドルウェア
- プレビューおよび本番デプロイメントのリクエスト

### 主な特徴

- ログはリアルタイムで表示され、リクエストごとにグループ化されます
- リクエストあたり最大256行のログ
- 各ログ行は最大256 KB
- リクエストあたりの合計ログデータは1 MBに制限

## 利用可能なログタイプ

1. **Vercel Function呼び出し**
   - Functionの実行ログ
   - エラーと警告
   - カスタムログ出力

2. **ルーティングミドルウェア呼び出し**
   - ミドルウェアの実行ログ
   - リライトとリダイレクト
   - リクエスト処理

3. **静的リクエスト（制限付き）**
   - 基本的なリクエスト情報
   - キャッシュステータス

## ランタイムログの表示

ランタイムログにアクセスするには：

1. ダッシュボードからプロジェクトを選択
2. 「Logs」タブをクリック
3. ログを表示、フィルタリング、検索

## ログフィルタ

### 利用可能なフィルタ

- **タイムライン**: 期間を選択
- **ログレベル**: Warning、Error
- **Function**: 特定のFunction
- **Host**: ホスト名
- **Deployment**: デプロイメント
- **Resource**: リソースタイプ
- **Request Type**: リクエストの種類
- **Request Method**: HTTPメソッド
- **Request Path**: URLパス
- **Cache Status**: キャッシュの状態
- **Browser-specific Logs**: ブラウザ固有のログ

## ログの詳細

各ログエントリには以下が含まれます：

### 基本情報

- **Request Path**: リクエストのパス
- **Timestamp (UTC)**: タイムスタンプ（UTC）
- **Status Code**: HTTPステータスコード
- **Host**: ホスト名
- **Request ID**: リクエストID

### メタデータ

- **User Agent**: ユーザーエージェント
- **Search Parameters**: 検索パラメータ
- **Firewall Status**: ファイアウォールの状態
- **Cache Status**: キャッシュの状態

### Function情報

- **Middleware Metadata**: ミドルウェアメタデータ
- **Function Metadata**: Functionメタデータ
- **Deployment Information**: デプロイメント情報

## 保持期間の制限

プランによるログ保持期間：

| プラン | 保持期間 |
|-------|----------|
| Hobby | 1時間 |
| Pro | 1日 |
| Pro with Observability Plus | 30日 |
| Enterprise | 3日 |
| Enterprise with Observability Plus | 30日 |

## ログの使用例

### エラーのデバッグ

1. エラーレベルでフィルタリング
2. エラーメッセージを確認
3. スタックトレースを分析
4. 問題を修正

### パフォーマンスの最適化

1. 遅いリクエストを特定
2. Function実行時間を分析
3. ボトルネックを発見
4. 最適化を実装

### リクエストフローの追跡

1. 特定のリクエストIDでフィルタリング
2. リクエストの全体フローを確認
3. ミドルウェアとFunctionの実行を追跡

## ベストプラクティス

### 効果的なログ記録

- 適切なログレベルを使用（info、warning、error）
- コンテキスト情報を含める
- 構造化されたログ形式を使用
- 機密情報をログに含めない

### ログの検索

- 特定のフィルタを組み合わせる
- リクエストIDを活用
- タイムスタンプ範囲を絞る

### ログの共有

- チームメンバーとログを共有
- 特定のログエントリへのリンクを使用
- フィルタ設定を保存

## 制限事項

### ログサイズの制限

- リクエストあたり256行
- 行あたり256 KB
- リクエストあたり合計1 MB

### 保持期間

- プランによって異なる
- より長い保持にはObservability Plusが必要
- 長期保存にはLog Drainsを使用

## トラブルシューティング

### ログが表示されない

- デプロイメントが完了していることを確認
- 正しい環境を選択
- フィルタ設定を確認

### ログが切り捨てられている

- ログサイズの制限を確認
- ログ出力を最適化
- 重要な情報を優先

## 次のステップ

- [Log Drains](/docs/drains)を設定して長期保存
- [Observability Plus](/docs/observability/observability-plus)にアップグレード
- [OpenTelemetry](/docs/otel)で詳細なトレーシングを実装

## 関連リソース

- [ログの概要](/docs/logs)
- [可観測性](/docs/observability)
- [セッショントレーシング](/docs/session-tracing)
- [モニタリング](/docs/query/monitoring)
