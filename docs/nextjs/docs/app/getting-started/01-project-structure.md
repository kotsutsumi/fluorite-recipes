# Next.jsプロジェクト構造

このページでは、Next.jsプロジェクトのファイルとフォルダ構造の概要を説明します。トップレベルのファイルとフォルダ、設定ファイル、および`app`と`pages`ディレクトリ内のルーティング規約について説明します。

## トップレベルのフォルダ

トップレベルのフォルダは、アプリケーションのコードと静的アセットを整理するために使用されます。

- **`app`**: App Router
- **`pages`**: Pages Router
- **`public`**: 提供される静的アセット
- **`src`**: オプションのアプリケーションソースフォルダ

## トップレベルのファイル

トップレベルのファイルは、アプリケーションの設定、依存関係の管理、ミドルウェアの実行、監視ツールの統合、環境変数の定義に使用されます。

### Next.js設定ファイル

- **`next.config.js`**: Next.jsの設定ファイル
- **`package.json`**: プロジェクトの依存関係とスクリプト
- **`middleware.ts`**: Next.jsリクエストミドルウェア
- **`.env`**: 環境変数
- **`.env.local`**: ローカル環境変数
- **`.env.production`**: 本番環境変数
- **`.env.development`**: 開発環境変数

### TypeScript設定

- **`tsconfig.json`**: TypeScriptの設定ファイル
- **`next-env.d.ts`**: Next.js用のTypeScript宣言ファイル

### ESLint設定

- **`.eslintrc.json`**: ESLintの設定ファイル

### その他

- **`.gitignore`**: Gitで無視するファイルとフォルダ
- **`.next-ignore`**: Next.jsで無視するファイルとフォルダ

## \`app\`ルーティング規約

以下のファイル規約は、\`app\`ルーターでルートを定義し、メタデータを処理するために使用されます。

### ルーティングファイル

- **\`layout\`**: \`.js\` \`.jsx\` \`.tsx\` - レイアウト
- **\`page\`**: \`.js\` \`.jsx\` \`.tsx\` - ページ
- **\`loading\`**: \`.js\` \`.jsx\` \`.tsx\` - ローディングUI
- **\`not-found\`**: \`.js\` \`.jsx\` \`.tsx\` - 404 UI
- **\`error\`**: \`.js\` \`.jsx\` \`.tsx\` - エラーUI
- **\`global-error\`**: \`.js\` \`.jsx\` \`.tsx\` - グローバルエラーUI
- **\`route\`**: \`.js\` \`.ts\` - APIエンドポイント
- **\`template\`**: \`.js\` \`.jsx\` \`.tsx\` - 再レンダリングされるレイアウト
- **\`default\`**: \`.js\` \`.jsx\` \`.tsx\` - パラレルルートのフォールバックページ

### ネストされたルート

- **\`folder\`**: ルートセグメント
- **\`folder/folder\`**: ネストされたルートセグメント

### 動的ルート

- **\`[folder]\`**: 動的ルートセグメント
- **\`[...folder]\`**: キャッチオールルートセグメント
- **\`[[...folder]]\`**: オプショナルキャッチオールルートセグメント

### ルートグループとプライベートフォルダ

- **\`(folder)\`**: ルーティングに影響を与えずにルートをグループ化
- **\`_folder\`**: フォルダとすべての子セグメントをルーティングから除外

### パラレルルートとインターセプトルート

- **\`@folder\`**: 名前付きスロット
- **\`(.)folder\`**: 同じレベルをインターセプト
- **\`(..)folder\`**: 1レベル上をインターセプト
- **\`(..)(..)folder\`**: 2レベル上をインターセプト
- **\`(...)folder\`**: ルートからインターセプト

### メタデータファイル規約

#### アプリアイコン

- **\`favicon\`**: \`.ico\` - ファビコンファイル
- **\`icon\`**: \`.ico\` \`.jpg\` \`.jpeg\` \`.png\` \`.svg\` - アプリアイコンファイル
- **\`icon\`**: \`.js\` \`.ts\` \`.tsx\` - 生成されたアプリアイコン
- **\`apple-icon\`**: \`.jpg\` \`.jpeg\` \`.png\` - Appleアプリアイコンファイル
- **\`apple-icon\`**: \`.js\` \`.ts\` \`.tsx\` - 生成されたAppleアプリアイコン

#### Open GraphとTwitter画像

- **\`opengraph-image\`**: \`.jpg\` \`.jpeg\` \`.png\` \`.gif\` - Open Graph画像ファイル
- **\`opengraph-image\`**: \`.js\` \`.ts\` \`.tsx\` - 生成されたOpen Graph画像
- **\`twitter-image\`**: \`.jpg\` \`.jpeg\` \`.png\` \`.gif\` - Twitter画像ファイル
- **\`twitter-image\`**: \`.js\` \`.ts\` \`.tsx\` - 生成されたTwitter画像

#### SEO

- **\`sitemap\`**: \`.xml\` - サイトマップファイル
- **\`sitemap\`**: \`.js\` \`.ts\` - 生成されたサイトマップ
- **\`robots\`**: \`.txt\` - Robotsファイル
- **\`robots\`**: \`.js\` \`.ts\` - 生成されたRobotsファイル

## \`pages\`ルーティング規約

以下のファイル規約は、\`pages\`ルーターでルートを定義するために使用されます。

### 特殊ファイル

- **\`_app\`**: \`.js\` \`.jsx\` \`.tsx\` - カスタムApp
- **\`_document\`**: \`.js\` \`.jsx\` \`.tsx\` - カスタムDocument
- **\`_error\`**: \`.js\` \`.jsx\` \`.tsx\` - カスタムエラーページ
- **\`404\`**: \`.js\` \`.jsx\` \`.tsx\` - 404エラーページ
- **\`500\`**: \`.js\` \`.jsx\` \`.tsx\` - 500エラーページ

### ルート

#### フォルダ規約

- **\`index\`**: \`.js\` \`.jsx\` \`.tsx\` - ホームページ
- **\`folder/index\`**: \`.js\` \`.jsx\` \`.tsx\` - ネストされたページ

#### ファイル規約

- **\`index\`**: \`.js\` \`.jsx\` \`.tsx\` - ホームページ
- **\`file\`**: \`.js\` \`.jsx\` \`.tsx\` - ネストされたページ

### 動的ルート

#### フォルダ規約

- **\`[folder]/index\`**: \`.js\` \`.jsx\` \`.tsx\` - 動的ルートセグメント
- **\`[...folder]/index\`**: \`.js\` \`.jsx\` \`.tsx\` - キャッチオールルートセグメント
- **\`[[...folder]]/index\`**: \`.js\` \`.jsx\` \`.tsx\` - オプショナルキャッチオールルートセグメント

#### ファイル規約

- **\`[file]\`**: \`.js\` \`.jsx\` \`.tsx\` - 動的ルートセグメント
- **\`[...file]\`**: \`.js\` \`.jsx\` \`.tsx\` - キャッチオールルートセグメント
- **\`[[...file]]\`**: \`.js\` \`.jsx\` \`.tsx\` - オプショナルキャッチオールルートセグメント

## プロジェクト整理の機能

### プライベートフォルダ

プライベートフォルダは、フォルダ名の前にアンダースコアを付けることで作成できます：\`_folderName\`

これは、フォルダがプライベートな実装の詳細であり、ルーティングシステムによって考慮されるべきではないことを示します。これにより、フォルダとそのすべてのサブフォルダがルーティングから除外されます。

\`app\`ディレクトリ内のファイルは、デフォルトで安全に配置できますが、プライベートフォルダは次のような場合に役立ちます：

- UIロジックをルーティングロジックから分離する
- プロジェクトとNext.jsエコシステム全体で内部ファイルを一貫して整理する
- コードエディタでファイルを並べ替えてグループ化する
- Next.jsの将来のファイル規約との潜在的な命名の競合を避ける

> **知っておくと良いこと**
>
> - Next.jsのフレームワーク規約ではありませんが、プライベートフォルダの外部のファイルを同じアンダースコアパターンを使用して「プライベート」としてマークすることも検討できます。
> - フォルダ名の前に\`%5F\`（アンダースコアのURLエンコード形式）を付けることで、アンダースコアで始まるURLセグメントを作成できます：\`%5FfolderName\`。
> - プライベートフォルダを使用しない場合は、予期しない命名の競合を防ぐために、Next.jsの特殊ファイル規約を知っておくと役立ちます。

### ルートグループ

ルートグループは、フォルダを括弧で囲むことで作成できます：\`(folderName)\`

これは、フォルダが組織的な目的のためのものであり、ルートのURLパスに含めるべきではないことを示します。

ルートグループは次のような場合に役立ちます：

- サイトセクション、意図、チーム別などのルートをグループ化する
- 同じルートセグメントレベルでネストされたレイアウトを有効にする：
  - 同じセグメント内に複数のネストされたレイアウトを作成する（複数のルートレイアウトを含む）
  - 共通セグメント内のルートのサブセットにレイアウトを追加する

### \`src\`ディレクトリ

Next.jsは、アプリケーションコード（\`app\`を含む）をオプションの\`src\`ディレクトリ内に保存することをサポートしています。これにより、アプリケーションコードをプロジェクトのルートにあることが多い設定ファイルから分離できます。

### モジュールパスエイリアス

Next.jsは、モジュールパスエイリアスをサポートしており、深くネストされたプロジェクトファイル間でのインポートの読み取りとメンテナンスが容易になります。

\`\`\`tsx
// 変更前
import { Button } from '../../../components/button'

// 変更後
import { Button } from '@/components/button'
\`\`\`

## プロジェクト整理戦略

Next.jsプロジェクトでファイルとフォルダを整理する際に「正しい」または「間違った」方法はありません。

以下のセクションでは、一般的な戦略の非常に高レベルな概要をリストしています。最も単純な要点は、チームで機能する戦略を選択し、プロジェクト全体で一貫性を保つことです。

> **知っておくと良いこと**：以下の例では、\`components\`と\`lib\`フォルダを一般化されたプレースホルダーとして使用していますが、その命名はフレームワークで特別な意味を持ちません。プロジェクトでは、\`ui\`、\`utils\`、\`hooks\`、\`styles\`などの他のフォルダを使用する場合があります。

### プロジェクトファイルを\`app\`の外に保存

この戦略では、すべてのアプリケーションコードをプロジェクトのルートにある共有フォルダに保存し、\`app\`ディレクトリは純粋にルーティング目的のために保持します。

\`\`\`
プロジェクトルート
├── app/
│   ├── layout.tsx
│   └── page.tsx
├── components/
│   └── Button.tsx
└── lib/
    └── utils.ts
\`\`\`

### プロジェクトファイルを\`app\`内のトップレベルフォルダに保存

この戦略では、すべてのアプリケーションコードを\`app\`ディレクトリのルートにある共有フォルダに保存します。

\`\`\`
プロジェクトルート
└── app/
    ├── components/
    │   └── Button.tsx
    ├── lib/
    │   └── utils.ts
    ├── layout.tsx
    └── page.tsx
\`\`\`

### プロジェクトファイルを機能またはルートごとに分割

この戦略では、グローバルに共有されるアプリケーションコードをルート\`app\`ディレクトリに保存し、より具体的なアプリケーションコードをそれを使用するルートセグメントに分割します。

\`\`\`
プロジェクトルート
└── app/
    ├── components/
    │   └── Button.tsx
    ├── lib/
    │   └── utils.ts
    ├── dashboard/
    │   ├── components/
    │   │   └── Chart.tsx
    │   ├── layout.tsx
    │   └── page.tsx
    ├── layout.tsx
    └── page.tsx
\`\`\`
