# 静的および動的レンダリング

前の章では、ダッシュボード概要ページのデータを取得しました。しかし、現在の設定には2つの制限があることを簡単に説明しました：

1. データリクエストが意図しないウォーターフォールを作成している
2. ダッシュボードが静的なので、データの更新がアプリケーションに反映されない

この章では...

ここで扱うトピックは次のとおりです

- 静的レンダリングとは何か、アプリケーションのパフォーマンスをどのように向上させるか
- 動的レンダリングとは何か、いつ使用するか
- ダッシュボードを動的にするためのさまざまなアプローチ
- 遅いデータ取得をシミュレートして何が起こるかを確認する

## 静的レンダリングとは

静的レンダリングでは、データの取得とレンダリングがビルド時（デプロイ時）または[データの再検証](https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating#revalidating-data)時にサーバー上で行われます。

ユーザーがアプリケーションにアクセスするたびに、キャッシュされた結果が提供されます。静的レンダリングにはいくつかの利点があります：

• **より高速なWebサイト** - プリレンダリングされたコンテンツは、[Vercel](https://vercel.com/)などのプラットフォームにデプロイされる際にキャッシュされ、グローバルに配信できます。これにより、世界中のユーザーがより迅速かつ確実にWebサイトのコンテンツにアクセスできるようになります
• **サーバー負荷の軽減** - コンテンツがキャッシュされているため、サーバーは各ユーザーリクエストに対して動的にコンテンツを生成する必要がありません。これにより、計算コストを削減できます
• **SEO** - プリレンダリングされたコンテンツは、ページの読み込み時にコンテンツが既に利用可能であるため、検索エンジンクローラーがインデックス化しやすくなります。これにより、検索エンジンランキングが向上する可能性があります

静的レンダリングは、データがないUI、または静的ブログ投稿や商品ページなど、ユーザー間で共有されるデータに有用です。個人化されたデータを定期的に更新するダッシュボードには適さない可能性があります。

静的レンダリングの反対は動的レンダリングです。

## 動的レンダリングとは

動的レンダリングでは、コンテンツがリクエスト時（ユーザーがページにアクセスした時）に各ユーザーのためにサーバー上でレンダリングされます。動的レンダリングにはいくつかの利点があります：

• **リアルタイムデータ** - 動的レンダリングにより、アプリケーションはリアルタイムまたは頻繁に更新されるデータを表示できます。これは、データが頻繁に変更されるアプリケーションに理想的です
• **ユーザー固有のコンテンツ** - ダッシュボードやユーザープロフィールなどの個人化されたコンテンツを提供し、ユーザーの操作に基づいてデータを更新することが容易になります
• **リクエスト時情報** - 動的レンダリングにより、Cookie やURL検索パラメータなど、リクエスト時にのみ知ることができる情報にアクセスできます

## 遅いデータ取得のシミュレーション

構築しているダッシュボードアプリケーションは動的です。

しかし、前の章で言及した問題が1つまだあります。1つのデータリクエストが他のすべてよりも遅い場合はどうなるでしょうか？

遅いデータ取得をシミュレートしてみましょう。`app/lib/data.ts` で、`fetchRevenue()` 内の `console.log` と `setTimeout` のコメントアウトを解除します：

```typescript
// /app/lib/data.ts
export async function fetchRevenue() {
  try {
    // デモ目的で人為的にレスポンスを遅延させます。
    // 本番環境ではこれを行わないでください :)
    console.log("Fetching revenue data...");
    await new Promise((resolve) => setTimeout(resolve, 3000));

    const data = await sql<Revenue[]>`SELECT * FROM revenue`;

    console.log("Data fetch completed after 3 seconds.");

    return data;
  } catch (error) {
    console.error("Database Error:", error);
    throw new Error("Failed to fetch revenue data.");
  }
}
```

新しいタブで [http://localhost:3000/dashboard/](http://localhost:3000/dashboard/) を開き、ページの読み込みに時間がかかることに注目してください。ターミナルでも次のメッセージが表示されるはずです：

```
Fetching revenue data...
Data fetch completed after 3 seconds.
```

ここでは、遅いデータ取得をシミュレートするために人為的に3秒の遅延を追加しました。結果として、データが取得されている間、ページ全体が訪問者にUIを表示することがブロックされます。これにより、開発者が解決しなければならない一般的な課題が生じます：

**動的レンダリングでは、アプリケーションは最も遅いデータ取得と同じ速度でしか動作しません。**

## 第8章を完了しました

素晴らしい！Next.js の静的および動的レンダリングについて学びました。

次は

**第9章：ストリーミング**

ストリーミングを追加してユーザー体験を改善する方法を学びます。

[第9章を開始](https://nextjs.org/learn/dashboard-app/streaming)
