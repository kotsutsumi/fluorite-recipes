# アプリバージョン管理

異なるバージョンタイプと、それらをリモートまたはローカルで管理する方法について学びます。

* * *

AndroidとiOSはそれぞれ、アプリのバージョンを識別するための2つの値を公開しています：ストアで表示されるバージョン（ユーザー向けバージョン）と開発者にのみ表示されるバージョン（開発者向けビルドバージョン）。このガイドでは、これらのバージョンをリモートまたはローカルで管理する方法を説明します。

## アプリバージョン

Expoプロジェクトでは、[app config](/workflow/configuration)ファイルで次のプロパティを使用してアプリバージョンを定義できます。

| プロパティ | 説明 |
|----------|-------------|
| `version` | ストアで表示されるユーザー向けバージョン |
| `android.versionCode` | Android用の開発者向けビルドバージョン |
| `ios.buildNumber` | iOS用の開発者向けビルドバージョン |

### アプリ内でのアプリバージョンの使用

アプリ内でユーザー向けバージョンを表示するには、`expo-application`ライブラリの`Application.nativeApplicationVersion`を使用できます。

アプリ内で開発者向けビルドバージョンを表示するには、`expo-application`ライブラリの`Application.nativeBuildVersion`を使用できます。

## 推奨ワークフロー

### ユーザー向けバージョン

本番リリースを行う際は、ユーザー向けバージョンを明示的に設定して更新する必要があります。アプリストアに提出する際は、app configの`version`プロパティを更新してください。

### 開発者向けビルドバージョン

開発者向けビルドバージョンについては、すべてのビルドで自動的にインクリメントするように設定できます。これにより、手動での変更を避け、重複するバージョン番号によるアプリストアの却下を防ぐことができます。

EAS Buildは、`remote`バージョンソースの使用を選択することで、開発者向けビルドバージョンを自動的に管理できます。

## リモートバージョンソース

> `remote`バージョンソースは、EAS CLIバージョン`12.0.0`からの推奨動作です。

EASサーバーは、アプリの開発者向けビルドバージョンを保存および管理できます。これを有効にするには、eas.jsonで`cli.appVersionSource`を`remote`に設定し、本番ビルドプロファイルで`autoIncrement`を`true`に設定します。

eas.jsonの例：
```json
{
  "cli": {
    "appVersionSource": "remote"
  },
  "build": {
    "production": {
      "autoIncrement": true
    }
  }
}
```

## ローカルバージョンソース

ローカルでバージョンを管理したい場合は、app configファイルで直接バージョンを更新します：

```json
{
  "expo": {
    "version": "1.0.0",
    "android": {
      "versionCode": 1
    },
    "ios": {
      "buildNumber": "1"
    }
  }
}
```

各ビルドの前に、これらの値を手動で更新する必要があります。

## バージョン管理のベストプラクティス

1. **セマンティックバージョニング**：ユーザー向けバージョンにはセマンティックバージョニング（例：1.0.0、1.1.0、2.0.0）を使用
2. **自動インクリメント**：開発者向けビルドバージョンにはリモート自動インクリメントを使用
3. **一貫性**：すべてのプラットフォームでバージョン番号体系を一貫させる
4. **ドキュメント化**：バージョン変更とリリースノートを追跡

これらのプラクティスに従うことで、アプリのバージョン管理プロセスを効率化できます。
