# プライバシーマニフェスト

## プライバシーマニフェストとは

プライバシーマニフェストは、`PrivacyInfo.xcprivacy`という名前のiOSファイルで、アプリが特定の機密性の高いAPIを使用する理由を宣言するために使用されます。

現在、これらのAPIには以下が含まれます：

- UserDefaultsへのアクセス
- ファイルタイムスタンプ
- システム起動時刻
- ディスクスペース
- アクティブなキーボード

Appleはこれを「将来拡張可能なオープンリスト」と考えています。

## app.jsonでの設定

`app.json`設定にプライバシーマニフェストを含めることができます：

```json
{
  "expo": {
    "ios": {
      "privacyManifests": {
        "NSPrivacyAccessedAPITypes": [
          {
            "NSPrivacyAccessedAPIType": "NSPrivacyAccessedAPICategoryUserDefaults",
            "NSPrivacyAccessedAPITypeReasons": ["CA92.1"]
          }
        ]
      }
    }
  }
}
```

### 設定の説明

- **`NSPrivacyAccessedAPITypes`**: アクセスするAPI型の配列
- **`NSPrivacyAccessedAPIType`**: 使用するAPIカテゴリ
- **`NSPrivacyAccessedAPITypeReasons`**: APIを使用する理由コード

## 主な推奨事項

### 1. Expo SDKライブラリの更新

```bash
npx expo install --fix
```

このコマンドでExpo SDKライブラリを最新バージョンに更新します。

### 2. サードパーティライブラリの確認

サードパーティライブラリが独自の`PrivacyInfo.xcprivacy`ファイルを持っているか確認してください。

### 3. 不明な場合は待つ

プライバシーマニフェストの詳細が不明な場合は、Appleからの通知を待つことができます。

## テスト

プライバシーマニフェストをテストする方法：

### 1. アプリのビルドと提出

アプリをビルドしてApp Store Connectに提出します。

### 2. App Storeレビュープロセスの確認

審査プロセスでプライバシーマニフェストの問題がないか確認します。

### 3. TestFlight外部レビューの確認

TestFlightの外部レビューを通じてフィードバックを収集します。

### 4. Appleからの通知を待つ

不足しているAPI理由についてのAppleからのメール通知を待ちます。

## 一般的なAPI理由コード

### UserDefaultsアクセス

- **CA92.1**: アプリの設定やその他のアプリ状態の読み取り/書き込み

### ファイルタイムスタンプ

- **C617.1**: バグ修正または機能リリースの前後でファイルに対して行われた変更の特定
- **3B52.1**: アプリケーション外で作成されたファイルの表示

### システム起動時刻

- **35F9.1**: デバイスが最後に再起動された時刻の測定
- **8FFB.1**: アプリが使用している絶対時間の測定

### ディスクスペース

- **E174.1**: ユーザーが要求したディスク容量の表示
- **85F4.1**: アプリケーション機能の有効化/無効化

### アクティブなキーボード

- **3EC4.1**: ユーザーが設定した現在のキーボードに基づくアプリの機能のカスタマイズ
- **54BD.1**: アクティブなキーボードのプライバシー情報の表示

## まとめ

プライバシーマニフェストは、iOSアプリが機密性の高いAPIを使用する理由を明確に宣言するための重要な仕組みです。適切に設定することで、App Storeの審査プロセスをスムーズに通過できます。
